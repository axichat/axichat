# Working Notes for email

- Basically a wrapper around Delta Chat Core Rust so that it works in this app. Email MUST be direct copy of the XMPP part of the app to the extent that Delta Chat will allow. Piggy back off as much existing chat code as you, can reuse as many chat widgets and models and functions as you can. If you see email code that has a similar purpose to chat code, just rewrite it to be like or reuse the chat code.
- NOT a bridge to Delta Chat; we use normal SMTP on the backend, we only use Delta Chat Core Rust to communicate with our SMTP server. Manages provisioning (`ensureProvisioned`), credential storage per JID, Delta transport initialization, foreground keepalive intervals, push notification flush, spam/blocking helpers, sync state stream, and shutdown/burn paths. Sends/receives delta events via `EmailDeltaTransport`, fans out messages with attachment size checks, validates recipient counts, and exposes `EmailAccount` helpers. Uses `CredentialStore`, `XmppDatabase` builder, `NotificationService`, `ForegroundTaskBridge`.
- MUST be completely removable from the app without consequences. If a user wants to self-host a server with no email, they can declare this preference and the app should still work.
